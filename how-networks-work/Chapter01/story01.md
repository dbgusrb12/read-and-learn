# HTTP 리퀘스트 메시지를 작성한다.

## 탐험 여행은 URL 입력부터 시작한다.

### URL (Uniform Resource Locator) 이란?

`http:`, `ftp:`, `file:`, `mailto:` 등으로 시작하는 문자열로,  
웹에 존재하는 수많은 자원들을 식별할 때 사용하는 식별자이며, 주소체계이다.   

맨 앞에 있는 문자열로 액세스하는 방법을 표현하며, 그 뒤에 오는 문자열은 액세스 대상에 따라 형식이 다르다.

### URL 의 형식

HTTP 프로토콜로 웹 서버에 액세스 하는 경우

- `http://사용자명(생략가능):패스워드(생략가능)@웹 서버의 도메인명:포트번호(생략가능)/파일의 경로명`
- ex) <http://user:password@www.hyungyu.co.kr:80/dir/file1.html>

FTP 프로토콜로 파일 다운로드/업로드 하는 경우

- `ftp://사용자명(생략가능):패스워드(생략가능)@FTP 서버의 도메인명:포트번호(생략가능)/파일의 경로명`
- ex) <ftp://user:password@ftp.hyungyu.co.kr:21/dir/file1.html>

클라이언트 PC 자체의 파일에서 데이터를 읽어오는 경우

- `file://컴퓨터명(생략가능)/파일의 경로명`
- ex) <file://localhost/c:/dir/file1.jpg>

메일을 송신하는 경우

- `mailto:메일주소`
- ex) <mailto:hyungyu@hyungyu.co.kr>

뉴스그룹의 기사를 읽는 경우

- `news:뉴스그룹명`
- ex) <news:sample.protocols.tcp-ip>

## 브라우저는 먼저 URL을 해독한다.

브라우저는 웹 서버에 보내는 리쿼스트의 메시지를 작성하기 위해 URL 을 해독한다.

### URL 의 요소 (HTTP 기준)

http://www.hyungyu.co.kr/dir/file1.html

위의 URL 을 기준으로,   
- `http:` : 데이터 출처에 액세스하는 방법 (프로토콜)
- `//` : 해당 문자 뒤에 오는 문자열이 서버의 이름임을 나타냄
- `www.hyungyu.co.kr` : 웹 서버명
- `/dir/file1.html` : /디렉토리/.../파일명 으로 되어있는 데이터 출처의 경로명

## 파일명을 생략한 경우

위의 나온 URL과 다르게 `/`로 끝나는 URL은 파일명을 생략한 경우로,  
서버측에서 설정한 파일을 액세스한다. (`default.htm`, `index.html`)  

### <http://www.hyungyu.co.kr/dir/>  

파일명만 생략된 경우, `/dir` 디렉토리 내에 기본 설정된 파일 액세스 (`/dir/default.htm`, `/dir/index.html`)

### <http://www.hyungyu.co.kr/>

파일명만 생략된 경우, 루트(`/`) 디렉토리 내에 기본 설정된 파일 액세스 (`/default.htm`, `/index.html`)

### <http://www.hyungyu.co.kr>

디렉토리명도 생략 된 경우, 루트(`/`) 디렉토리 내에 기본 설정된 파일 액세스 (`/default.htm`, `/index.html`)

### <http://www.hyungyu.co.kr/whatisthis>

규칙에 따르면 whatisthis 를 파일명으로 보는게 맞지만, 웹 서버에 해당 이름의 파일이 있으면 파일명으로,  
해당 이름의 디렉토리가 있으면 디렉토리로 취급하는 것이 통례이다. (`/whatisthis`, `/whatisthis/index.html`, `/whatisthis/default.htm`)

같은 이름을 가진 디렉토리와 파일은 존재 할 수 없기 때문에 둘 다 있는 경우는 없다.

## HTTP의 기본 개념

HTTP 프로토콜은 클라이언트와 서버가 주고받는 메시지의 내용이나 순서를 정한 것.

### HTTP 의 순서
1. 클라이언트에서 서버를 향해 리퀘스트 메시지를 보낸다.
2. 서버에서는 리퀘스트 메시지를 해독하고, 해당 요구에 따라 동작한 뒤 결과를 응답 메시지에 저장한다.
3. 서버에서 만든 응답 메시지를 클라이언트에 반송한다.
4. 클라이언트에 도착하여 브라우저가 메시지의 안에서 데이터를 추출하고, 화면에 표시한다.

### 리퀘스트 메시지의 구성 요소

리퀘스트 메시지의 내부에는 '무엇을', '어떻게 해서' 하겠다는 내용이 쓰여있다.

'무엇을' 에 해당하는 것을 URI(Uniform Resource Identifier) 라고 하는데, 일반적으로 페이지 데이터를 저장한 파일의 이름이나,   
CGI 프로그램의 파일명을 URI 로 사용한다.

'어떻게 해서' 에 해당하는 것이 메소드로, 이 메소드에 의해 웹 서버에 어떤 동작을 하고 싶은지 전달한다.

#### 메소드

- `GET` : URI로 지정한 정보를 도출한다. 파일의 경우 해당 파일의 내용을 되돌려 보내고, CHI 프로그램의 경우 해당 프로그램의 출력 데이터를 그대로 반송한다.
- `POST` : 클라이언트에서 서버로 데이터를 송신한다. 폼에 입력한 데이터를 송신하는 경우에 사용
- `HEAD` : `GET` 과 거의 동일하지만, HTTP 메시지의 헤더만 반송하고 데이터의 내용은 돌려보내지 않는다. 파일 최종 갱신 일시와 같은 속성 정보를 조사 할 때 사용
- `OPTIONS` : 통신 옵션을 통지하거나 조사할 때 사용
- `PUT` : URI로 지정한 서버의 파일을 치환한다. URI로 지정한 파일이 없는 경우에는 새로 파일을 작성
- `DELETE` : URI로 지정한 서버의 파일을 삭제한다.
- `TRACE` : HTTP 버전 1.1에서 사용하는 메소드로, 서버측에서 받은 리퀘스트 라인과 헤더를 그대로 반송한다. 프록시 서버 등을 사용하는 환경에서 리퀘스트가 치환되는 상태를 조사할 때 사용
- `CONNECT` : HTTP 버전 1.1에서 사용하는 메소드로, 암호화한 메시지를 프록시로 전송할 때 사용하는 메소드

## HTTP 리퀘스트 메시지를 만든다.

URL을 해독하고, 웹 서버와 파일명을 판단하면 브라우저는 이 정보를 바탕으로 HTTP 리퀘스트 메시지를 만든다.
HTTP 메시지는 포맷이 결정되어 있어서, 브라우저는 해당 포맷에 맞게 리퀘스트 메시지를 만든다.

### 리퀘스트 메시지의 형식

```
<메소드><공백><URI><공백><HTTP 버전>
<필드명>:<필드값>
<필드명>:<필드값>
.
.
.
.
.
<공백 행>
<메시지 본문>
```
첫번째 행을 '리퀘스트 라인' 이라고 한다.   
이 한 행으로 리퀘스트의 내용을 대략 알 수 있다.

두번째 행 부터 공백 행 까지를 '메시지 헤더' 라고 한다.   
한 행에 한개의 헤더 필드를 사용하고, 이를 통해 리퀘스트의 부가적인 정보를 나타낸다.   

공백 행 이후를 '메시지 본문' 이라고 한다.   
메시지 본문의 내용은 클라이언트에서 서버에 송신하는 데이터이고,   
폼 페이지에 입력한 데이터를 POST 메소드로 웹 서버에 보낼 때 등에 데이터가 들어간다.

### 응답 메시지의 형식

```
<HTTP 버전><공백><스테이터스 코드><공백><응답 문구>
<필드명>:<필드값>
<필드명>:<필드값>
.
.
.
.
.
<공백 행>
<메시지 본문>
```

첫번째 행을 '스테이터스 라인' 이라고 한다.   
스테이터스 코드의 내용을 나타내는 짧은 설명문이다.

두번째 행 부터 공백 행 까지를 '메시지 헤더' 라고 한다.   
리퀘스트 메시지의 헤더 부분과 동일하며, 들어가는 값은 응답에 대한 헤더 값들을 나타낸다.

공백 행 이후를 '메시지 본문' 이라고 한다.   
응답 메시지의 본문 내용은 서버에서 클라이언트에 송신하는 데이터,   
파일에서 읽은 데이터나 CGI 애플리케이션이 출력한 데이터가 들어간다.   
메시지 본문은 바이너리 데이터로 취급한다.

### HTTP 의 스테이터스 코드

스테이터스 코드는 100번대 부터 500번대 까지 존재한다.

- `1xx` : 처리의 경과 상황등을 통지한다.
- `2xx` : 정상 종료
- `3xx` : 무언가 다른 조치가 필요함
- `4xx` : 클라이언트측의 오류
- `5xx` : 서버측의 오류


### 리퀘스트, 응답의 헤더에는 종류가 여러가지가 있다. (추후 따로 정리)