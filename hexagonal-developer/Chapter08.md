# 아키텍처 • 패턴

주니어 개발자와 중간 • 시니어 개발자를 구분 짓는 요소 중 하나로 아키텍처 설계 역략을 꼽을 수 있다.  
능력있는 시니어 개발자가 되고 싶다면 아키텍처도 신경 써야 한다.

## 아키텍처 고민하기

아키텍처의 정의는 다음과 같다.

> 소프트웨어 아키텍처는 소프트웨어 시스템의 추상적인 구조다.  
> 각 구조는 소프트웨어 요소, 요소간의 관계, 요소화 관계의 속성(프로퍼티) 로 구성된다.

마이크로서비스, MVC(Model-View-Controller), MVP(Model-View-Presenter) 또한 아키텍처이다.

어디까지가 아키텍처이고 어디서부터가 상세 설계에 속하는지 명확하게 구분하기 어렵지만  
확실한 것은 아키텍처가 설계 과정에서 나오는 결과물이라는 것이다.

### 아키텍처를 결정하는 요인

아키텍처를 결정할 때는 크게 2가지를 고려해야 한다.

- 기능 요구 사항
- 품질 속성 또는 비기능 요구 사항

#### 기능 요구 사항

기능 요구 사항은 소프트웨어로 해결하고자 하는 문제와 관련이 있다.  
만들고자 하는 소프트웨어가 모바일 전용 학습 서비스라면 수강 관리, 교육과정 관리, 학습 진도 추적 등 과 같은 요구사항이 존재하는데,  
이런게 기능 요구 사항에 해당한다.

#### 품질 속성

품질 속성은 요구 사항이나, 업무 도메인, 또는 경험에서 도출 된다.
 
요구 사항에서 도출되는 품질 속성은 성능과 확장성 등이 있다.  
보통 요구 사항 문서에 최대 사용자 수, 최대 트래픽 같은 형태로 성능과 확장성을 언급한다.  
수용해야 하는 트래픽 규모와 패턴에 따라 아키텍처도 단순해지거나 복잡해진다.

업무 도메인에서 도출되는 품질 속성의 대표적인 예는 법률 요건이다.  
도메인에 따라 준수해야 하는 법이 존재하고, 이 법을 준수하기 위해 구조에 영향을 주기도 한다.

경험에서 도출되는 품질 속성은 가용성, 인증/인가, 유지보수성 등이 있다.
  
대부분의 온라인 서비스는 24시간 서비스를 제공하기 때문에 요구 사항에 가용성이 포함되어 있지 않더라도 아키텍처를 설계할 때 당연히 가용성을 고려해야 한다.  
또한 인증과 인가도 요구 사항에 포함되어 있지 않더라도 로그인한 사용자가 누구인지 알 수 있어야 하며, 허용한 대상만 특정 기능에 접근 할 수 있어야 한다.

중요한 품질 속성 중 하나가 유지보수성이다.  
성능 같은 속성은 겉으로 잘 드러나는 반면에 유지보수성은 잘 드러나지 않는다.  
하지만 유지보수성이 나쁘면 시스템을 변경하고 개선하는 데 들어가는 비용이 증가하게 되며 결국 서비스의 경쟁력이 떨어지게 된다.  
가용성, 성능, 보안 못지않게 중요한 품질 속성이 바로 유지보수성이다.

### 트레이드오프

품질 속성을 높이면 시스템의 복잡도가 증가한다.  
가용성, 성능, 확장성, 보안, 신뢰성, 유지보수성, 지역화, 연속성등 아키텍처와 관련된 품질 속상은 다양하다.  
모든 품질 속성을 높일 수 있다면 이상적이겠지만 불가능에 가깝다.  
각 품질 속성을 높이면 시스템 복잡도는 배 이상 증가하고, 서로 영향을 주는 품질 속성도 있기 때문이다.  
보통 보안을 높이면 성능은 떨어지고, 가용성이나 성능을 높이면 장비 사용 비용이 증가한다.

푹질 속성을 높이면 복잡도와 비용이 증가하고 서로 상충하는 품질 속성도 존재하기 때문에 아키텍처를 선택할 때 높이고자 하는 품질 속성 간의 절충이 필요하다.  
IT 업계에서 자주 사용되는 말 중 하나인 "그때그때 다르다(It depends on)" 는 아키텍처에도 적용된다.

모든면에서 최고인 아키텍처를 추구하면 안되고, 가장 나쁘지 않은 아키텍처를 선택해야 한다.

### 주요 아키텍처 품질 속성

주요 품질 속성은 다음과 같다.

| 용어                          | 정의                                                                      |
|-----------------------------|-------------------------------------------------------------------------|
| 가용성(Availability)           | 시스템이 얼마나 오랫동안 사용할 수 있는지를 나타내는 속성이다. 99.99%와 같이 사용 가능 시간/전체 시간 비율로 표시한다. |
| 성능(Performance)             | 시스템의 최대 처리량. 평균 응답시간 등을 포함하는 속성이다.                                      |
| 확장성(Scalability)            | 자원을 추가해서 증가한 사용자나 트래픽을 처리할 수 있는 시스템의 속성이다.                              |
| 탄력성(Elasticity)             | 필요에 따라 자원을 추가하거나 반환하는 능력이다.                                             |
| 견고성(Robustness))            | 실행 중에 발생하는 에러나 잘못된 입력을 다루는 능력이다.                                        |
| 결함 허용(Fault tolerance)      | 일부 기능에 장애가 발생해도 시스템이 운영을 지속할 수 있는 능력이다.                                 |
| 신뢰성/안정성(Reliability/safety) | 시스템 고장에 대비한 안전장치가 필요한지 또는 생명에 영향을 주는 중요한 시스템인지를 나타내는 속성이다.              |
| 유지보수성(Maintainability)      | 얼마나 쉽게 시스템을 변경하고 향상할 수 있는지를 나타내는 속성이다.                                  |
| 지역화(Localization)           | 다양한 언어에 대한 지원을 표현하는 속성이다.                                               |
| 테스트 가능성(Testability)        | 소프트웨어 결과물이 주어진 테스트 환경에서 얼마나 테스트할 수 있는지를 나타낸다.                           |
| 합법성(Legal)                  | 시스템이 지켜야 할 법적 규제나 요건을 나타낸다.                                             |
| 보안(Security)                | 데이터베이스에 암호화해서 저장해야 할 데이터, 통신 구간의 암호화 등을 나타내는 속성이다.                      |
| 배포 가능성(Deployability)       | 개발한 결과물을 제품에 쉽게 반영할 수 있는 정도를 표현한다.                                      |
| 추적성(Traceability)           | 무언가를 추적할 수 있는 능력이다.                                                     |

### 아키텍처가 중요한 이유

시스템이 커질수록 전체 시스템 설계가 개별 구현보다 중요해진다.  
어떤 아키텍처를 선택했느냐에 따라 기능 구현에 제약받는 상황이 벌어지기 때문이다.  
아키텍처에 주의를 기울이지 않으면 원하는 품질을 달성하지 못하고 실패할 가능성도 커진다.

적정 소프트웨어 아키텍처 라는 책에서 아키텍처가 중요한 4가지 이유를 언급하고 있다.

- 아키텍처는 시스템의 골격 역할을 한다.
- 아키텍처는 품질 속성에 영향을 미친다.
- 아키텍처는 (대부분) 기능과 직교한다.
- 아키텍처는 시스템을 제한한다.

#### 아키텍처는 시스템의 골격 역할을 한다.

만들려는 시스템에 따라 적합한 아키텍처가 존재한다.  
데이터 일관성이 중요한 API 서버는 트랜잭션 처리가 용이한 아키텍처가,  
채팅 시스템을 위한 서버는 비동기 메시징 처리가 용이한 아키텍처가 적합 할 수 있다.

#### 아키텍처는 품질 속성에 영향을 미친다.

선택한 아키텍처에 따라 높일 수 있는 품질 속성이 있고, 높이기 어려운 품질 속성이 있다.  
마이크로 서비스 아키텍처는 탄력성, 배포 가능성(독립적 배포)이 커지지만 데이터 무결성을 위한 구조는 더 복잡해진다.

#### 아키텍처는 기능과 직교한다.

아키텍처는 품질 속성뿐만 아니라 기능 구현에도 영향을 준다.  
API 서버를 비동기 프레임워크로 구현하면 일부 성능 지표를 높일 수 있지만, 관리자를 위한 백오피스 기능이나 CPU 연산이 많은 작업에는 적합하지 않다.

